# TDD

### TDD란?

`TDD`란 `Test Driven Development`의 약자로 `테스트 주도 개발` 을 뜻합니다. `TDD`는 소프트웨어 개발자가 실제 코드를 작성하기 전에 테스트 코드를 먼저 작성하는 방식이다. 이 방식의 기본적인 발상은 실제 코드를 작성하기 전에 코드 작성자가 전체적인 설계나 요구 사항에 대해 생각하는 시간을 주는 것이다. `TDD`를 가장 쉽게 표현한 것이 아래의 `Red-Green-Refactor`(RGR) 개발 주기이다.

![RGR 개발 주기](https://user-images.githubusercontent.com/80724255/159267488-e7be24d6-3ecf-4891-825d-eb34b4a0cc13.png)

### TDD 개발주기

- **{ Red } 단계에서는 테스트 코드를 작성한다.**
- **{ Green } 단계에서는 테스트 코드를 성공시키기 위한 실제 코드를 작성한다.**
- **{ Refactor } 단계에서는 중복 코드 제거, 일반화 등의 리팩토링을 수행한다.**

중요한 것은 실패하는 테스트 코드를 작성할 때까지 실제 코드를 작성하지 않는 것과, 실패하는 테스트를 통과할 정도의 최소 실제 코드를 작성해야 하는 것이다. 이를 통해 실제 코드에 대해 기대되는 바를 보다 명확하게 정의함으로써 불필요한 설계를 피할 수 있고, 정확한 요구 사항에 집중할 수 있다.

### TDD의 과정

![TDD의 과정](https://user-images.githubusercontent.com/80724255/159267592-e4e102c3-4dad-456b-9b0e-33d59567f7c4.png)

1. 하나의 작은 단위의 테스트 코드를 작성한다.
2. 테스트를 한다.
3. 테스트가 통과될 때까지 코드를 수정한다.
4. 테스트가 통과된 코드는 리팩토링을 한다.
5. 리팩토링한 코드를 테스트한다.
6. 리팩토링한 코드가 통과 될때까지 코드를 수정한다.
7. 테스트가 통과되면 테스트 케이스에 있는 다음 코드를 작성한다.

이처럼 `TDD`는 작은 단위부터 시작하여 점진적으로 개발한다. 이때 일련의 반복적인 과정을 통해 자연스럽게 코드는 명확해지고 깔끔해진다.

### 일반 개발 방식과 TDD 개발 방식의 비교

**일반 개발 방식: `요구사항 분석` → `설계` → `개발` → `테스트` → `배포`**

![일반 개발 방식](https://user-images.githubusercontent.com/80724255/159267711-5be6663b-100f-4289-9068-18d515272dc9.png)

일반 개발 방식은 소프트웨어 품질 저하의 잠재적 위험이 존재한다. 어느 프로젝트든 초기 설계가 완벽하다고 말할 수 없기 때문이다. 고객의 요구사항 또는 디자인의 오류 등 많은 외부 또는 내부 조건에 의해 재설계 과정을 거치게 된다. 재설계 과정에서 개발자는 코드를 삽입**·**수정**·**삭제하게 되고, 불필요한 코드가 남거나 중복처리 될 가능성이 높다. 결론적으로 코드 관리와 재사용이 어려워져 유지보수를 어렵게 만든다.

**TDD 개발 방식: `요구사항 분석` → `설계` → `테스트 코드 작성` → `개발` → `리팩토링` → `배포`**

![TDD 개발 방식](https://user-images.githubusercontent.com/80724255/159267756-80f2563b-a4bd-4ac8-bff7-08f341322a3c.png)

TDD와 일반 개발 방식의 가장 큰 차이는 위에서 봤듯이 테스트 코드를 작성한 뒤에 실제 코드를 작성하는 것이다. 디자인(설계) 단계에서 프로그래밍의 목적을 반드시 미리 정의해야 하고, 무엇보다 무엇을 테스트해야 할지 미리 정의해야 한다. 테스트 코드를 작성하는 도중 발생하는 예외 사항(버그 및 수정사항)은 테스트 케이스에 추가하고 설계를 개선한다. 이러한 단계가 반복적으로 진행되면서 자연스럽게 코드의 버그가 줄어들고, 소스 코드가 간결해진다.

### TDD 개발 방식의 장단점

`TDD` **장점**

1. **튼튼한 객체 지향적인 코드 생산:** `TDD`는 코드의 재사용성을 높여주므로 기능 별 철저한 모듈화가 이루어 진다.
2. **재설계 시간의 단축:** 테스트 코드를 먼저 작성하기 때문에 개발자가 지금 무엇을 해야하는지 분명히 정의하고 개발을 시작하게 된다. 이는 개발 진행 중 소프트웨어의 전반적인 설계가 변경되는 일을 방지할 수 있다.
3. **디버깅 시간의 단축:** 특정 오류가 발생한다면 실제 관련된 모든 레이어를 디버깅 해야하지만 `TDD`의 경우 자동화 된 테스트로 특정 버그를 손 쉽게 찾아낼 수 있다.
4. **추가 구현의 용이함:** 개발 완료된 소프트웨어에 어떤 기능을 추가할 때 해당 기능이 기존 코드에 어떤 영향을 미칠지 예측하지 못한다는 경우가 있다. `TDD`의 경우 자동화된 테스트로 즉각적으로 확인할 수 있다.

`TDD` **단점**

1. **단기적인 생산성 저하:** 하나의 기능에 두 개의 코드를 작성해야 하고, 테스트를 고쳐가며 코드를 작성해야 한다. `TDD` 방식의 개발 시간은 통상 일반적인 개발 방식에 비해 대략 10 ~ 30% 늘어나는 것으로 알려져 있다. 장기적인 관점에서는 유지, 보수가 용이해 생산성이 개선된다고 보기도 한다.

### TDD 연구 결과

1. **TDD는 기존 개발 방식보다 느리다? 빠르다?**

- Microsoft와 IBM팀 소프트웨어 엔지니어들의 사례 연구는 `TDD` 기술을 사용했을 때 ‘팀들은 초기 개발 시간이 15-35% 정도 늘어났다.’ 라고 결론지었다. 하지만 이 숫자들은 ‘경영진에서 주관적으로 추정한’ 수치이다.
- 품질이 개선되었다는 Microsoft와 IBM의 연구의 관점에서 보았을 때, 만약 장기적으로 본다면 `TDD`는 나중에 결함들을 고쳐야하는 시간을 절약해줄 수 있다고 볼 수 있다. Microsoft와 IBM 팀도 이 주장에 동의했다.
- `TDD`는 처음 초기 단계에서 느려 보인다. 하지만 장기적으로 보았을 때 더 높은 품질의 코드로 절약된 시간이 초기 단계에서 쓴 시간을 상쇄시켜줄 수 있다. 또한 프로그래머들이 `TDD`에 능숙해지는만큼 더 빨리 작업할 수 있게 해준다고 볼 수 있다.

2. **TDD가 버그를 줄여주는가?**

- Microsoft와 IBM 엔지니어링 팀의 연구는 ‘`TDD` 방식을 사용하지 않은 유사한 프로젝트에 비해 4개 결과물의 시험판 결함 밀도가 40%에서 90%까지 감소했다.’라고 발표했다. 특히 IBM 팀은 결함 밀도가 40%, Microsoft는 60-90% 감소되었다고 한다.

3. **TDD의 코드 품질에 대한 통계는?**

- 핀란드에서 열린 IEEE(전기전자학회)의 2007년 첫 번째 국제 심포지엄에서 발표된 연구 결과를 기반으로 Maria Siniaalto와 Pekka Abrahamsson은 `TDD`로 개발되지 않은 소프트웨어와 비교할 때 `TDD`가 더 나은 코드 품질을 생성한다는 것을 발표했다.
- 그들의 논문에서는 `TDD`가 프로세스 트래킹과 작업 판단을 향상시켰다는 중국에서 진행된 연구를 인용한다. 동일한 연구에서는 ‘`TDD`는 또한 다음과 같은 일관된 관행과 가이드라인을 개선한다’라고 정리한다. 결과적으로 더 적은 오류와 품질이 높아진다. 또한 `TDD`를 사용한 팀은 오류를 더욱 더 빠르게 수정할 수 있었다.

4. **TDD는 단순한 설계를 도와주는가?**

- North Carolina State University 컴퓨터학부의 Boby George와 Laurie Williams는 24명의 프로그래머를 두 그룹으로 나누는 실험을 했다. 한 그룹은 `TDD`를 사용하고 또 다른 그룹은 선형적인 방식을 사용하게 한 것이다.
- 그들은 참가자들 중 ‘92%는 `TDD`가 높은 품질의 코드를 생산해낸다고 여겼고, 79%는 `TDD`가 단순한 설계를 이끈다고 생각했으며, 71%는 이 방법이 특출나게 효과적이었다라는 의견을 냈다.’라고 발표하였다.

### 그렇다면 어떠한 경우에 TDD 적용해야 할까?

- **개발 환경과 프로젝트 상황을 고려해야 한다.**
    - 소프트웨어 품질보다 납기일을 준수해야 하는 경우에는 바람직하지 않다.
    - 지속적으로 유지, 보수를 해나가야 하는 장기 프로젝트에 적합하다.

- **인적 자원의 비용을 고려해야 한다.**
    - 지금까지 자신이 개발하던 방식을 바꾸는 것이기 때문에 단기적인 생산성 하락이 예상된다.
    - 테스트 프레임 워크를 새롭게 학습하기 위한 시간과 노력이 소요된다.
    
- **불확실성을 고려해야 한다.**
    - 고객의 요구 조건이 바뀌는 등 외부 불확실성이 높은 프로젝트에 적합하다.
    - 처음 시도하는 도메인으로 인해 자기 자신에 대한 불확실성이 높은 경우에 적합하다.
    - 개발 이후에 유지보수를 누가할 것인지 불확실한 경우에 적합하다.

### 참고

[**참고: 테스트 주도 개발의 이점에 대한 통계와 연구**](https://www.hanbit.co.kr/media/channel/view.html?cms_code=CMS6706987091)

[**참고: “Test Driven Development is overrated”**](https://levelup.gitconnected.com/test-driven-development-is-overrated-ad9f0491c11d)

[**참고 : [Agile] TDD(테스트 주도 개발)란 – Heee’s Development Blog**](https://gmlwjd9405.github.io/2018/06/03/agile-tdd.html)

[**참고 : [기술면접] TDD(Test-Driven-Development) 방법론에 대해서**](https://wooaoe.tistory.com/33)

[**참고 : TDD란?**](https://m.blog.naver.com/PostView.nhn?blogId=suresofttech&logNo=221039173819&proxyReferer=https:%2F%2Fwww.google.com%2F)

[**참고 : 선택이 아닌 필수 TDD**](https://ahea.wordpress.com/2018/09/10/%EC%84%A0%ED%83%9D%EC%9D%B4-%EC%95%84%EB%8B%8C-%ED%95%84%EC%88%98-tdd/)

[**참고 : 코드 품질을 높여주는 테스트 주도 개발 알아보기**](https://www.samsungsds.com/kr/insights/Test-Driven-Development.html?referrer=https://wooaoe.tistory.com/33)
