# 암호학

## 키와 주소

이더리움은 외부 소유 계정(EOA)과 컨트랙트라는 두 가지 유형의 계정을 갖고 있다. 디지털 개인키, 이더리움 주소, 디지털 서명을 통해 외부 소유 계정의 이더 소유권을 확립한다. 개인키는 모든 사용자와 이더리움 간 상호작용의 핵심이다. 계정 주소는 개인키에서 직접 파생되고, 개인키는 계정이라고도 불리는 단일 이더리움 주소를 고유하게 결정한다.

이더리움 시스템은 개인키를 이더리움에 전송하거나 저장하는 방식으로 직접 사용하지 않는다. 개인키는 비공개로 유지되어야 하고, 네트워크로 전달된 메시지에 나타나지 않으며, 체인에 저장되어서도 안 된다.

개인키를 사용하여 생성된 디지털 서명을 통해 자금의 접근과 통제가 이루어진다. 이더리움 트랜잭션은 유효한 디지털 서명이 블록체인에 있어야 한다. 개인키의 사본을 가진 사람은 누구나 해당 계정과 해당 계정이 가진 이더를 제어할 수 있다. 사용자가 자신의 개인키를 안전하게 유지한다면, 이더리움 트랜잭션의 디지털 서명은 개인키의 소유권을 증명하기 때문에 자금의 실제 소유자임도 증명한다.

이더리움과 같은 공개키 암호화 기반 시스템에서 키는 개인키와 공개키로 구성된 쌍으로 제공한다. 공개키는 은행 계좌 번호, 개인키는 PIN과 유사하다고 볼 수 있다. 후자는 계정에 대한 제어권을 제공하고, 전자를 가지고 계정을 식별할 수 있다.

외부 소유 계정의 이더리움 주소는 공개키-개인키 쌍의 공개키 부분에서 생성된다. 그러나 모든 이더리움 주소가 공개키-개인키 쌍을 나타내는 것은 아니다.

## 공개키 암호화와 암호화폐

공개키 암호화(비대칭 암호화)는 오늘날 정보 보안의 핵심 요소다. 공개키 암호화는 고유한 키를 사용해 정보를 보호한다. 이 키는 특수한 속성을 가진 수학 함수를 바탕으로 한다. 이 함수를 바탕으로한 암호화는 디지털 비밀과 위조 불가능한 디지털 서명을 만들 수 있으며, 이것은 수학 법칙에 의해 보장받는다.

역산하기 위한 단축키로 사용할 수 있는 비밀 정보가 없으면 거꾸로 계산하기 어려운 함수를 트랩 도어 함수라고 한다. 타원 곡선의 산술 연산은 수학 함수의 더 발전된 범주인데, 타원 곡선 산술에서 소수로 나눈 나머지를 곱하는 것은 간단하지만, 나눗셈(역함수)은 사실상 불가능하다. 이를 이산 로그 문제라고 하며, 알려진 트랩 도어는 없다. 타원 곡선 암호화는 최신 컴퓨터 시스템에서 광범위하게 활용되며, 이더리움에서 개인키와 디지털 서명을 사용하는 기초가 된다.

공개키는 개인키에서 파생되므로 쌍으로 간주한다. 그 쌍은 공개적으로 접근할 수 있는 계정 핸들(주소)와 계정의 이더에 대한 접근 권한, 스마트 컨트랙트를 사용할 때 계정이 필요로 하는 모든 인증에 대한 사적 제어권을 제공함으로써 이더리움 계정을 나타낸다. 개인키는 계정에서 자금을 지출하기 위해 트랜잭션에 서명해야 하는 디지털 서명을 만드는 데 필요한 고유한 정보의 접근을 제어한다. 디지털 서명은 소유자 또는 컨트랙트 사용자를 인증하는 데도 사용한다.

디지털 서명을 만들어 모든 메시지에 서명할 수 있다. 이더리움 트랜잭션에서는 트랜잭션 자체의 세부사항이 메시지로 사용된다. 암호 수학은 메시지를 개인키와 결합해 개인키를 알아야만 만들 수 있는 코드 생성 방법을 제공한다. 이 코드를 디지털 서명이라고 한다. 이더리움 트랜잭션은 기본적으로 특정 이더리움 주소로 특정 계정에 접근하는 요청이다. 자금을 이동하거나 스마트 컨트랙트와 상호작용하기 위한 트랙잭션을 이더리움 네트워크로 보내면, 문제의 이더리움 주소에 해당하는 개인키로 생덩된 디지털 서명도 함께 보내야 한다. 타원 곡선 수학이란 디지털 서명, 트랜잭션 세부 정보, 접근하려는 이더리움 주소가 일치하는지 확인해 ‘누구나' 트랜잭션이 유효한지 확인할 수 있음을 의미한다. 이러한 확인 과정에는 개인키가 전혀 포함되지 않는다. 개인키는 개인 영역에 남아 있다. 그러나 검증 프로세스에서는 의심의 여지 없이 그 트랜잭션이 공개키에 대응되는 개인키를 가진 사람에 의해 만들어졌음을 확증할 수 있다.

## 개인키

개인키는 단순히 무작위로 선택한 숫자다. 개인키의 소유권과 제어는 해당 주소를 승인하는 컨트랙트에 대한 접근뿐만 아니라 해당 이더리움 주소와 관련된 모든 자금에 대한 사용자 제어의 근원이다. 개인키는 트랜잭션에 쓰이는 자금의 소유권을 증명함으로써 이더를 소비하는데 필요한 서명을 만드는 데 사용된다. 개인키는 항상 비밀로 유지해야 한다. 개인키를 잃어버리면 해당 키로 확보한 자금을 영원히 읽기 때문에 반드시 백업해야 한다.

## 난수로 개인키 생성

키를 생성하는 가장 중요한 첫 번째 단계는 엔트로피, 즉 무작위성을 확보하는 것이다. 이더리움 개인키를 생성하는 것은 기본적으로 1에서 2의 256승 사이의 숫자를 선택하는 것이라고 볼 수 있다. 이더리움 소프트웨어는 기본 운영체제의 난수 생성기를 사용해 256개의 임의 비트를 생성한다. 

정확히는 2의 256승보다 약간 작은 0이 아닌 매우 큰 숫자까지 가능하다. 정확한 숫자는 첫 번째 38자리를 2의 256승으로 공유하며, 이더리움에서 사용된 타원 곡선의 순서로 정의한다. 비공개 키를 생성하기 위해 256비트 숫자를 무작위로 추출해 유효한 범위 내에 있는지 확인한다. 프로그래밍 측면에서 이것은 일반적으로 더 큰 임의의 비트 문자열을 Keccak-256 또는 SHA-256 같은 256비트 해시 알고리즘에 공급함으로써 이루어진다.
